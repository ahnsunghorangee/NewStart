# http 통신을 이용한 양방향 통신기법, long polling



웹에서 양방향 통신은 사실상 웹소캣으로 기결



#### http는 절대 양방향이 되지 않는다

<center>
    <img src="https://t1.daumcdn.net/cfile/tistory/997C22475C28B0D410" />
</center>

> http는 양방향이 되지 않는 모델이다. request, response 형태로 단방향만 가능하다.



#### http는 서버에서 원하는 타이밍에 클라이언트에게 데이터를 보낼 수 없다.

<center>
    <img src="https://t1.daumcdn.net/cfile/tistory/991BC1505C28B1C010" />
</center>

> client만이 server에 요청할 수 있다.







하지만 양방향 통신을 해야되는 상황에 봉착하게 되고, (웹소캣이 없었을 때) http를 이용한 초기모델 polling 기법 탄생







#### polling이란? 나는 너를 계속해서 관찰하겠어.

<center>
    <img src="https://t1.daumcdn.net/cfile/tistory/993027435C28B49603" />
</center>

> 가장 무식한 방법, 일정 시간 간격으로 물어보는 간격이다. 하지만 장점도 존재한다.

#### http polling의 특징

1. 주기적으로 물어봄으로 **응답 간격을 일정**하게 할 수 있다.
2. 주기적으로 몰아서 물어보는게 가능하므로 자동으로 **배치 프로세싱(일괄처리)**되어서 db튜닝을 하는 효과가 나온다.
3. **실시간으로 주는건 불가능**하다. 실시간 효과를 내려면 간격을 줄여야 하지만 서버와 클라이언트 모두에게 부담이다.
4. **보낼 데이터가 없어도 계속해서 데이터를 줘야**하므로 서버의 리소스를 낭비하게 된다.

> 일괄적으로 물어보는 점이 장점, 대용량 데이터를 처리해야 한다면 polling 기법은 아직도 유효하며 간단하고 최적화된 방식이다.



> 문제는 실시간성이다. 실시간처럼 시간 간격을 줄이면 데이터를 마구 보낸다. 하지만 http는 단발성 통신이기에 header가 매우 무거운 프로토콜 중 하나이다. 이 프로토콜이 계속 보내진다면 서버 과부하가 발생한다.







그래서 새로운 기법 고안 http long polling 기법







#### long polling 나는 너랑 연결이 끊기지 않을꺼야

<center>
    <img src="https://t1.daumcdn.net/cfile/tistory/99A9F74C5C28BF1A2A" />
</center>

기본 방식은 polling처럼 무한히 물어보는 것



차이점은 polling은 주기적으로 물어본다면, long polling은 일단 보내고 time out될 때까지 무한정 기다린다는 것



#### timeout이란?

- 사전적으로, '프로그램이 특정한 시간 내에 성공적으로 수행되지 않아서 진행이 자동적으로 중단되는 것'
- 응답을 무한정 기다릴 수 없기 때문에 기다릴 시간을 정한다.



#### http long polling의 특징

1. 항상 연결이 유지되어 있다.
2. 변경에 매우 민감하게 반응한다. 사실상 실시간으로 통신이 가능하다.
3. 데이터가 주어지는 즉시 바로 반응하고 보내므로 요청 간격이 줄어든다면 polling보다 훨씬 데이터를 많이 보내게 된다.

